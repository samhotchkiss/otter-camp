# Issue #110 ‚Äî Chameleon Agent Architecture

> **Status: READY** ‚Äî Reviewed by Derek + Frank. Ship it.

## Vision

Replace any multi-agent OpenClaw setup with a 2-agent model:
1. **Primary** ‚Äî the user's main persona (whatever they named it), handles direct human interaction
2. **Chameleon** ‚Äî a blank-slate agent that assumes any identity on demand

This works on any OpenClaw instance ‚Äî new or existing, regardless of agent names or count. OtterCamp detects the existing setup, imports it, and simplifies it.

Agent identities, personalities, and memories live entirely in OtterCamp. OpenClaw becomes a pure execution engine: LLM routing, tool execution, workspace filesystem access. OtterCamp is the brain; OpenClaw is the hands.

## Why

- **Adding an agent today** requires: OpenClaw config changes, workspace directory creation, symlink setup, bootstrap file creation, Slack app setup, binding config. ~30 minutes of manual work.
- **Adding an agent after this**: Create a record in OtterCamp's web UI. Done. 30 seconds.
- **Removing an agent**: Delete in OtterCamp. No OpenClaw changes.
- **Migrating to a new machine**: Install OpenClaw + bridge. OtterCamp serves all identity/memory. Zero manual file setup.

## Architecture

### OpenClaw Config (minimal)

After OtterCamp onboarding, any OpenClaw instance reduces to this shape:

```jsonc
{
  agents: {
    list: [
      {
        id: "<primary_agent_id>",    // detected from existing config (default agent)
        name: "<primary_agent_name>",
        workspace: "~/.openclaw/workspace"
        // Primary agent keeps its workspace (or also OtterCamp-managed)
      },
      {
        id: "chameleon",
        name: "Chameleon",
        workspace: "~/.openclaw/workspace-chameleon"
        // Minimal workspace ‚Äî AGENTS.md with identity-fetch instructions only
      }
    ]
  }
}
```

The primary agent is auto-detected: whichever agent has `default: true` or is the first in the list. OtterCamp doesn't assume names ‚Äî it reads the existing config and preserves the primary.

### Workspace Access + Project-Bound Execution (MUST)

All work product generated by Chameleon must live in OtterCamp project repos and be committed/pushed. The local Chameleon workspace is control-plane context only (`AGENTS.md`, bootstrap files, local memory mirror), not a general file output destination.

Two execution modes:

1. **Conversation mode** (no project attached)
   - Read-only interaction allowed (chat, planning, analysis)
   - File mutation tools are denied: `write`, `edit`, `apply_patch`
   - Sandbox uses `workspaceAccess: "none"` so the host workspace is not exposed

2. **Project mode** (task produces work product)
   - Dispatch must include `project_id` (optional `issue_id`)
   - Bridge resolves/creates a local checkout for that project and sets session cwd to that repo/worktree root
   - All file writes must stay under that project root (path guard enforced)
   - Definition of done includes at least one commit and push associated with the task/issue

**Concurrent safety:** if multiple sessions target the same project, bridge uses per-session git worktrees (`.../worktrees/{sessionKey}`) to prevent clobbering.

**Out of scope for v1:** automatic fallback to an agent-specific "misc" project when `project_id` is missing. For v1, missing `project_id` means read-only mode.

### Enforcement Limits (v1, policy-level)

Because current OpenClaw integration points do not expose file-write interception hooks for `write`/`edit`/`apply_patch`, execution-mode restrictions are enforced at prompt/policy level in v1.

- `project` mode path guard statements are policy-level guidance until write hooks are available.
- `conversation` mode mutation denial is policy-level guidance plus `workspaceAccess: none`.
- **TODO (hardening):** wire per-write path validation into OpenClaw write interception hooks and re-check symlink segments at write time to close TOCTOU gaps.

### Chameleon AGENTS.md (the key file)

This is the only file that matters in the Chameleon workspace. It's injected into the system prompt on every run and survives compaction:

```markdown
# Agent Instructions

## Identity
Your identity is managed by OtterCamp. You are a multi-identity agent.

**On every session start, or if you're unsure who you are after a compaction:**
1. Run: `otter agent whoami --session $SESSION_KEY --profile compact`
2. This returns the default identity payload for normal runs
3. If identity context is insufficient, run: `otter agent whoami --session $SESSION_KEY --profile full`
4. Embody that identity completely for this session
5. Never guess your identity ‚Äî always verify via OtterCamp

## Memory
- To read your memory: included in the `whoami` response
- To write a memory: `otter memory write --agent <uuid> "what you want to remember"`
- To search your memory: `otter memory search --agent <uuid> "query"`
- Daily notes: `otter memory write --agent <uuid> --daily "what happened today"`

## Files & Workspace
- If no `project_id` is attached to this session, stay read-only (no file writes)
- If `project_id` is present, do all work inside that project repo/worktree
- Never write outside the active project root
```

### Session Flow

#### Session Naming

Session keys use UUIDs for routing but include a human-readable label so anyone debugging can instantly see what's going on:

- **Session key** (for routing): `agent:chameleon:oc:{agentUUID}`
- **Display name** (for humans): `"Derek ‚Äî Engineering Lead"` or `"Nova ‚Äî Blog post draft"`

The bridge sets the session's `displayName` and `origin.label` when creating it. This shows up in:
- `openclaw sessions` CLI output
- OtterCamp connections/diagnostics page
- Session store JSON
- Any debug logs

Format: `"{AgentName} ‚Äî {TaskSummary}"` or just `"{AgentName}"` for open-ended chat.

#### New Session (OtterCamp-initiated)

1. User in OtterCamp clicks "Chat with Derek" or assigns a task to Derek
2. OtterCamp creates a dispatch via the bridge
3. Bridge starts a session on the `chameleon` agent with key `agent:chameleon:oc:{agentUUID}`
4. Bridge sets `displayName: "Derek ‚Äî Engineering Lead"` on the session
5. Bridge fetches identity payload with `whoami --profile compact` and injects an identity preamble:
   ```
   [OtterCamp Identity Injection]
   You are Derek, Engineering Lead.

   Identity profile: compact
   Personality summary: {soul_summary}
   Identity summary: {identity_summary}
   Recent memory summary: {recent_memory_summary}
   Active tasks: {task pointers}

   Task: {user's message or task description}
   ```
6. LLM responds as Derek
7. Subsequent messages in the same session don't need re-injection ‚Äî identity is in conversation history

#### Post-Compaction Recovery

1. Session gets compacted (context window pressure)
2. Identity details in conversation history get summarized
3. On next run, the Chameleon's AGENTS.md instruction fires (it's in the system prompt, always present)
4. Agent calls `otter agent whoami --session agent:chameleon:oc:{agentId} --profile compact`
5. If compact payload is insufficient, agent retries with `--profile full`
6. Agent re-establishes identity and continues

#### Session Reset (daily at 4am)

1. Session expires and a new one is created
2. Next inbound message triggers identity injection again (same as new session flow)
3. Memory persists in OtterCamp regardless of session lifecycle

### OtterCamp-Initiated Communication

When Sam wants to talk to Derek:
1. Opens Derek's chat in OtterCamp UI
2. Types a message
3. OtterCamp dispatches to bridge ‚Üí OpenClaw Chameleon agent
4. Session key encodes the identity: `agent:chameleon:oc:{agentId}`
5. If session exists (not expired), message goes to existing conversation
6. If new session, identity gets injected first

### Memory Architecture

#### Storage (dual-write)

Memories are written to **both** locations simultaneously:

1. **OtterCamp database** ‚Äî source of truth, portable, searchable, survives machine changes
2. **Local filesystem** ‚Äî `~/.openclaw/workspace-chameleon/memory/{agentUUID}/` ‚Äî fast reads, works offline, compatible with OpenClaw's built-in `memory_search` tool

The `otter memory write` command writes to both. The bridge syncs any drift on startup (OtterCamp wins on conflict). If OtterCamp is unreachable, local writes still succeed and sync later.

**Local layout:**
```
~/.openclaw/workspace-chameleon/memory/
  {agentUUID}/
    MEMORY.md              # long-term
    2026-02-09.md          # daily
    2026-02-08.md
```

**OtterCamp DB schema:** `agent_memories` table
  - `id` (uuid, PK)
  - `agent_id` (uuid, FK ‚Üí agents.id) ‚Äî all reads/writes keyed off UUID, never name/slug
  - `kind` (text) ‚Äî "daily", "long_term", "note"
  - `date` (date) ‚Äî for daily memories
  - `content` (text) ‚Äî markdown content
  - `embedding` (vector, optional) ‚Äî for semantic search
  - `created_at`, `updated_at` timestamps

This means OpenClaw's `memory_search` tool works out of the box (searches local markdown files), AND OtterCamp has the full history for its UI, search, and portability.

All API endpoints and CLI commands use the agent UUID as the identifier. Display names are for humans only ‚Äî never used as keys.

#### API Endpoints

```
GET  /api/agents/{id}/whoami?session_key=...&profile=compact|full
     Returns: identity payload for session (default `compact`)

GET  /api/agents/{id}/memory?days=2&include_long_term=true
     Returns: recent daily memories + long-term memory

POST /api/agents/{id}/memory
     Body: { kind: "daily"|"long_term"|"note", content: "..." }
     Writes a memory entry

GET  /api/agents/{id}/memory/search?q=...
     Returns: semantically relevant memory snippets
```

`whoami` profiles:
- `compact` (default): minimal identity + summarized memory + task pointers
- `full`: full SOUL/IDENTITY/instructions + richer memory payload for deep recovery/debug

#### CLI Commands

```bash
# Identity
otter agent whoami --session <key> --profile compact   # default path for normal runs
otter agent whoami --session <key> --profile full      # deep recovery/debug
otter agent list                                        # List all agents (shows id + name)
otter agent create "Name" --role "..."                 # Create new agent (returns UUID)

# Memory (all --agent flags take UUID)
otter memory write --agent <uuid> "learned X today"
otter memory write --agent <uuid> --daily "shipped the auth refactor"
otter memory search --agent <uuid> "auth refactor"
otter memory read --agent <uuid> --days 3
```

Note: The `whoami` command resolves the agent UUID from the session key automatically. All other commands require the UUID directly. `otter agent list` shows the mapping.

#### The `whoami` Response (example: `profile=full`)

```json
{
  "agent": {
    "id": "a1b2c3d4-5678-90ab-cdef-1234567890ab",
    "name": "Derek",
    "role": "Engineering Lead",
    "emoji": "üèóÔ∏è",
    "avatar": "avatars/derek.png"
  },
  "soul": "# SOUL.md\n\nYou are Derek...",
  "identity": "# IDENTITY.md\n\n- Name: Derek\n- Creature: ...",
  "memory": {
    "today": "# 2026-02-09\n- Fixed auth bug...",
    "yesterday": "# 2026-02-08\n- Reviewed PRs...",
    "long_term": "# MEMORY.md\n\n## Key Decisions\n...",
    "long_term_truncated": false
  },
  "active_tasks": [
    {
      "project": "Otter Camp",
      "issue": "#42",
      "title": "Implement WebSocket reconnection",
      "status": "in_progress"
    }
  ],
  "instructions": "# AGENTS.md\n\n## Your Role\n..."
}
```

Compact response omits large raw fields (`soul`, `identity`, full `instructions`) and returns summarized equivalents for normal runs.

## Installation / Migration Flow

### New Install
1. User installs OtterCamp + OpenClaw + bridge
2. OtterCamp setup wizard detects OpenClaw
3. Scans existing agent workspaces: `~/.openclaw/workspace-*`
4. For each agent found:
   - Reads SOUL.md, IDENTITY.md, MEMORY.md, memory/*.md, TOOLS.md
   - Creates agent record in OtterCamp with imported data
   - Leaves original workspace untouched as legacy data (no auto-archive in v1)
5. Configures OpenClaw with 2-agent setup (primary + chameleon)
6. Creates minimal Chameleon workspace with AGENTS.md instructions
7. Disables legacy agent automation paths (heartbeats, bindings, and cron targets that reference retired agent sessions)
8. User verifies agents appear in OtterCamp UI
9. Done ‚Äî agents are now OtterCamp-managed

### Existing OtterCamp User
1. OtterCamp detects connected OpenClaw instance via bridge
2. Reads `openclaw.json` ‚Üí discovers all agents and their workspace paths
3. For each non-primary agent: imports identity + memory files into OtterCamp
4. Creates `chameleon` agent config
5. Patches OpenClaw config down to 2 agents (primary + chameleon)
6. Leaves old workspaces in place as legacy read-only data (no auto-archive in v1)
7. Disables legacy agent automation paths (heartbeats, bindings, and cron targets that reference retired agent sessions)
8. All agents now managed via OtterCamp

### Legacy Agent Transition File (generated during migration)

For each retired legacy workspace, migration writes `LEGACY_TRANSITION.md` and prepends a short pointer in `AGENTS.md` so the instruction is always visible in context.

Purpose of the transition file:
- Explain that OtterCamp + Chameleon is now the active execution path
- Require project-bound execution for all work product
- Require creating a project when a task has no project yet
- Require commit + push after every meaningful work step

Required checklist in `LEGACY_TRANSITION.md`:
1. If task has no project, create one before writing deliverables (`otter project create ...`)
2. Clone/open project repo and do all file writes inside that repo
3. Commit with required message format and push
4. Link commit(s) back to the OtterCamp task/issue
5. Do not keep final work product in the legacy workspace

This file is a migration guardrail for manual legacy-session use only; primary routing remains OtterCamp ‚Üí Chameleon.

## What Changes Where

### OtterCamp (backend)
- [ ] Agent identity storage (DB schema for soul, identity, instructions per agent)
- [ ] Agent memory storage (DB schema + API)
- [ ] `GET /api/agents/{id}/whoami` endpoint
- [ ] `whoami` profile modes (`compact` default, `full` optional) with payload caps
- [ ] Memory CRUD endpoints
- [ ] Memory search (semantic, optional)
- [ ] Chat dispatch that injects identity into first message
- [ ] Dispatch contract for project mode (`project_id` required for writable tasks)
- [ ] Task completion recorder (commit/push metadata linked to task/issue)
- [ ] Migration/import tool for existing workspaces
- [ ] Legacy workspace transition-file writer (`LEGACY_TRANSITION.md` + AGENTS pointer)

### OtterCamp (frontend)
- [ ] Agent identity editor (already partially exists from Spec 103)
- [ ] Agent memory viewer/editor
- [ ] "Add Agent" creates a full agent record (not just a roster entry)
- [ ] Chat with any agent (dispatches to Chameleon with identity injection)

### Otter CLI
- [ ] `otter agent whoami --session <key>` command
- [ ] `otter agent whoami --profile compact|full` support
- [ ] `otter memory write/read/search` commands
- [ ] `otter agent create/edit/archive` commands

### Bridge
- [ ] Dispatch handler injects identity on new/reset sessions
- [ ] Detects compaction events and can re-inject identity
- [ ] Session key encoding: `agent:chameleon:oc:{agentId}`
- [ ] Call `whoami --profile compact` by default and escalate to `full` only when needed
- [ ] Enforce execution mode: read-only when no `project_id`, project mode when present
- [ ] Resolve project checkout/worktree and set session cwd to project root
- [ ] Enforce write path guard (deny writes outside active project root)
- [ ] Track/emit commit + push metadata for task completion

### OpenClaw
- [ ] Use existing OpenClaw hooks/config only in v1 (no new core hooks required by this spec)
- [ ] Config change: reduce to 2 agents (primary + chameleon)
- [ ] Chameleon sandbox defaults include restricted workspace access for non-project sessions (`workspaceAccess: "none"`)
- [ ] Any control that cannot be enforced via existing hooks is explicitly marked as policy-level (not hard-enforced) until a future hook exists

## Open Source / Local-First Constraints

This ships as an open source package that anyone can run locally. Every design decision must respect:

1. **No cloud dependency** ‚Äî OtterCamp server runs on localhost. The DB is local SQLite or Postgres ‚Äî user's choice. Nothing phones home. No account required.

2. **Single-machine default** ‚Äî The happy path is OtterCamp + OpenClaw + bridge all on one machine. No external services, no Docker required for basic use. `npm install` or single binary and go.

3. **No vendor lock-in** ‚Äî Memory, identity, and agent data exportable as plain files (markdown + JSON) at any time. `otter export` dumps everything to a directory structure that works without OtterCamp.

4. **Offline-capable** ‚Äî Local filesystem writes always work. OtterCamp DB is local. The only network calls are to LLM providers (which the user configures). If someone runs this air-gapped with a local model, it still works.

5. **No hardcoded infra assumptions** ‚Äî No Railway, no Vercel, no specific hosting. The hosted version (sam.otter.camp) is one deployment of the same open source code. Config, not code, differentiates self-hosted from managed.

6. **Portable agent data** ‚Äî Import/export agents as a tarball or directory. Move agents between machines, share agent templates, fork someone's agent config. The agent identity format is an open spec, not a proprietary blob.

7. **Minimal dependencies** ‚Äî Go binary for the server, Node for the bridge (already required by OpenClaw). No Redis, no Elasticsearch, no external services for core functionality. Semantic search is optional and can use local embeddings.

## Open Questions

1. **Slack routing**: If agents still need individual Slack accounts for channel presence, we'd keep the bindings but the Slack-routed sessions would also use the `whoami` pattern. Or we consolidate to Frank-on-Slack + OtterCamp for everything else.

2. **Concurrent sessions**: Can two agents (Derek + Nova) run simultaneously on the single Chameleon? Yes ‚Äî they'd have different session keys. OpenClaw handles concurrent sessions on the same agent fine.

3. **Heartbeats**: Do non-Frank agents still need heartbeats? Probably not if they're task-driven via OtterCamp. Only Frank needs a heartbeat for Slack responsiveness.

4. **No-project writes fallback**: For v1, missing `project_id` is read-only. In a future iteration, should we auto-route one-off work to an agent-owned `misc` project?

5. **Memory search integration**: OpenClaw's built-in `memory_search` tool searches local markdown files. We'd need to either (a) configure it to call OtterCamp's search API, or (b) have the bridge sync memory files locally per-agent. Option (b) is simpler for v1.

6. **Model management (TODO callout)**: Add support for agent-level default model plus optional per-session runtime model override in dispatch/session controls.

## Implementation

Ship it all at once. This is one spec for Codex ‚Äî no phases, no partial rollouts.

### Single-Drop End-to-End Readiness Gates (required)

Before enabling Chameleon routing as the default path, all of these must pass in one integrated test run:
- Migration dry-run report is clean on a real local OpenClaw config
- Legacy automation shutdown is verified (no retired-agent heartbeat/cron/binding activity)
- Project-bound execution checks pass (read-only without `project_id`, path guard in project mode)
- Identity recovery checks pass (`whoami --profile compact` default, `full` fallback)
- Rollback path is verified (restore pre-migration config + resume legacy routing)

This keeps shipping as a single drop while still enforcing an explicit go/no-go bar for end-to-end validation.

### Quality + Reliability Requirements (non-negotiable)

#### 1) Extensive testing built in
- Unit tests: identity resolver, session-key parsing, mode gating, path guard, model/profile selection
- Integration tests: OtterCamp API + bridge + OpenClaw runtime interactions
- End-to-end tests: full migration ‚Üí dispatch ‚Üí work-product commit flow on a local machine
- Regression tests: legacy import idempotency + rollback correctness
- Security tests: path traversal/symlink escape, session spoof attempts, unauthorized mode escalation
- Performance tests: concurrency and sustained-load chat/task runs

#### 2) Fail-safes
- Fail-closed defaults:
  - Missing `project_id` ‚áí read-only mode
  - Identity resolution failure (`whoami`) ‚áí no writable execution
- Idempotency keys on migration + dispatch operations to prevent duplicate side effects
- Safe rollback checkpoint before cutover (config snapshot + validation hash)
- Clear error states surfaced to OtterCamp UI (never silent failure)

#### 3) Security hardening
- Validate all IDs/session keys as UUID-backed canonical formats (no display-name routing)
- Canonicalize paths and block writes outside active project root (including symlink traversal)
- Keep least-privilege tool policy in conversation mode (no mutation tools)
- Audit log every privileged transition (mode change, project root assignment, rollback)

#### 4) Performance hardening
- Default to `whoami --profile compact`; use `full` only when needed
- Enforce payload caps on identity/memory injection to control token growth
- Add caching for stable identity payload fragments per session (bounded TTL)
- Apply bounded concurrency + backpressure on bridge dispatch processing

#### 5) Self-repair
- Startup reconciler repairs memory mirror drift (DB ‚Üî local files) with deterministic conflict handling
- Retry queue for transient bridge/OtterCamp API failures with capped backoff
- Health watchdog marks stuck dispatches and auto-recovers or escalates with actionable error
- Periodic integrity checks for session mapping (`sessionKey ‚Üí agentUUID ‚Üí project root`) and automatic repair when safe

### Backend
- Agent identity storage (DB schema: soul, identity, instructions, tools per agent)
- Agent memory storage (DB schema + CRUD + search endpoints)
- `GET /api/agents/{id}/whoami` endpoint
- `whoami` profile modes (`compact` default, `full` optional) + payload caps
- Memory endpoints: read, write, search, daily
- Chat dispatch with identity injection on new/reset sessions
- Dispatch mode contract (`project_id` required for writable tasks)
- Idempotency keys for migration + dispatch writes
- Audit log records for privileged transitions and fallback/rollback events
- Task completion metadata capture (commit SHA + push status linked to task/issue)
- Migration/import endpoint for existing workspaces

### CLI
- `otter agent whoami --session <key> --profile compact|full`
- `otter agent list / create / edit / archive`
- `otter memory write / read / search`

### Bridge
- Dispatch handler injects identity on new/reset sessions
- Session key encoding: `agent:chameleon:oc:{agentId}`
- Compaction detection + re-injection
- Call `whoami --profile compact` by default; retry with `full` when needed
- Enforce read-only mode when `project_id` is missing
- Resolve project checkout/worktree and set session cwd
- Enforce write path guard to active project root
- Retry queue + capped backoff for transient OtterCamp/OpenClaw failures
- Dispatch watchdog for stuck sessions with safe recovery/escalation path
- Periodic integrity checker (`sessionKey ‚Üí agentUUID ‚Üí project root`) with safe auto-repair
- Emit commit/push metadata back to OtterCamp task timeline

### Frontend
- Agent identity editor (soul, identity, instructions, tools)
- Agent memory viewer/editor
- "Add Agent" creates a full record
- Chat dispatch routes through Chameleon with identity injection

### Migration
- Workspace scanner: reads existing `~/.openclaw/workspace-*` directories
- Imports SOUL.md, IDENTITY.md, MEMORY.md, memory/*.md, TOOLS.md per agent
- Creates agent records in OtterCamp
- Writes `LEGACY_TRANSITION.md` + AGENTS pointer into retired legacy workspaces
- Leaves old workspaces untouched in v1 (legacy read-only fallback)
- Disables legacy agent automation paths (heartbeats, bindings, and cron targets)

### Verification + Hardening Test Plan
- Unit suite: parsers, guards, mode resolver, profile selection
- Integration suite: OtterCamp API + bridge + OpenClaw runtime paths
- E2E suite: migration/cutover/rollback + project-bound execution + identity recovery
- Security suite: path traversal, symlink escape, unauthorized escalation, malformed session keys
- Performance suite: concurrency soak and latency/cost budget checks
- Chaos suite: transient API failures, delayed responses, partial restart recovery

Release gate: all suites green in the same build before enabling Chameleon as default routing.

## Execution Log

- [2026-02-09 11:01 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress and created branch codex/spec-110-chameleon-agent-architecture from origin/main | Tests: n/a
- [2026-02-09 11:05 MST] Issue #465 | Commit n/a | created | Planned canonical chameleon session-key parser/validation issue with explicit tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #466 | Commit n/a | created | Planned backend whoami compact/full profile endpoint issue with explicit tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #467 | Commit n/a | created | Planned backend agent memory CRUD/search API issue with explicit tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #468 | Commit n/a | created | Planned CLI agent command suite issue (whoami/list/create/edit/archive) with explicit tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #469 | Commit n/a | created | Planned CLI memory command suite issue (write/read/search) with explicit tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #470 | Commit n/a | created | Planned bridge identity preamble injection issue with compact/full fallback tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #471 | Commit n/a | created | Planned bridge execution-mode, worktree, and path-guard enforcement issue with security tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #472 | Commit n/a | created | Planned commit/push completion metadata capture issue (bridge + backend) with idempotency tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #473 | Commit n/a | created | Planned legacy workspace import and transition-file generation issue with idempotency tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #474 | Commit n/a | created | Planned 2-agent config cutover + rollback safeguards issue with validation tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #475 | Commit n/a | created | Planned frontend identity/memory management and chameleon-chat UX issue with component tests | Tests: n/a
- [2026-02-09 11:05 MST] Issue #476 | Commit n/a | created | Planned integrated single-drop release gate suite issue with cross-surface tests | Tests: n/a
- [2026-02-09 11:09 MST] Issue #465 | Commit 0c142e4 | closed | Added canonical chameleon session-key parser/validator helpers in Go + bridge TS and updated extraction call sites with legacy fallback | Tests: go test ./internal/api/session_keys.go ./internal/api/session_keys_test.go -count=1; npm run test:bridge; go test ./internal/api -run 'Test(Extract|Validate)ChameleonSessionKey|TestExtractSessionAgentIdentity' -count=1 (fails due pre-existing settings_test type errors)
- [2026-02-09 11:09 MST] Issue #465 | Commit 0c142e4 | pushed | Pushed issue #465 implementation commit to origin/codex/spec-110-chameleon-agent-architecture and posted close evidence | Tests: go test ./internal/api/session_keys.go ./internal/api/session_keys_test.go -count=1; npm run test:bridge
- [2026-02-09 11:09 MST] Issue #n/a | Commit n/a | in_progress | Opened PR #477 for reviewer visibility on spec-110 branch | Tests: n/a
- [2026-02-09 11:14 MST] Issue #466 | Commit e409bf4 | closed | Added /api/agents/{id}/whoami compact/full endpoint, canonical session-key validation, route wiring, and migration 048 identity columns | Tests: go test ./internal/api -run 'TestAgentWhoAmI' -count=1; go test ./internal/api -run 'Test(AgentWhoAmI|Extract|Validate)ChameleonSessionKey|TestExtractSessionAgentIdentity' -count=1; npm run test:bridge; go test ./internal/store -run 'TestAgentStore' -count=1 (fails due pre-existing project_issue_store_test compile errors)
- [2026-02-09 11:14 MST] Issue #466 | Commit e409bf4 | pushed | Pushed whoami endpoint implementation and posted closure evidence on GitHub issue #466 | Tests: go test ./internal/api -run 'TestAgentWhoAmI' -count=1; npm run test:bridge
- [2026-02-09 11:19 MST] Issue #467 | Commit e299123 | closed | Added agent_memories migration/store and memory read/write/search endpoints with workspace validation and tests | Tests: go test ./internal/api -run 'TestAgentMemory' -count=1; go test ./internal/api -run 'TestAgent(WhoAmI|Memory)' -count=1; go test ./internal/store/agent_memory_store.go ./internal/store/agent_memory_store_test.go ./internal/store/store.go ./internal/store/test_helpers_test.go -run 'TestAgentMemoryStore' -count=1; npm run test:bridge
- [2026-02-09 11:19 MST] Issue #467 | Commit e299123 | pushed | Pushed memory API implementation and posted closure evidence on GitHub issue #467 | Tests: go test ./internal/api -run 'TestAgentMemory' -count=1; npm run test:bridge
- [2026-02-09 11:25 MST] Issue #468 | Commit 82c68da | closed | Added otter agent command group (whoami/list/create/edit/archive) and CLI client agent whoami/create/update/archive methods with targeted tests | Tests: go test ./cmd/otter -count=1; go test ./cmd/otter -run 'Test(ParseChameleonSessionAgentID|SlugifyAgentName)' -count=1; go test ./internal/ottercli/client.go ./internal/ottercli/config.go ./internal/ottercli/client_agent_test.go -run 'TestAgentClientMethodsUseExpectedPathsAndPayloads' -count=1; npm run test:bridge
- [2026-02-09 11:25 MST] Issue #468 | Commit 82c68da | pushed | Pushed CLI agent command implementation and posted closure evidence on GitHub issue #468 | Tests: go test ./cmd/otter -count=1; npm run test:bridge
- [2026-02-09 11:30 MST] Issue #469 | Commit 7e30544 | closed | Added `otter memory` command group (write/read/search), UUID validation, kind resolution, and CLI memory client methods with request-path tests | Tests: go test ./cmd/otter -run 'TestMemory' -count=1; go test ./internal/ottercli/client.go ./internal/ottercli/config.go ./internal/ottercli/client_memory_test.go -run 'TestMemory' -count=1; go test ./cmd/otter -count=1; npm run test:bridge
- [2026-02-09 11:30 MST] Issue #469 | Commit 7e30544 | pushed | Pushed CLI memory command implementation and posted corrected closure evidence on GitHub issue #469 | Tests: go test ./cmd/otter -run 'TestMemory' -count=1; go test ./internal/ottercli/client.go ./internal/ottercli/config.go ./internal/ottercli/client_memory_test.go -run 'TestMemory' -count=1
- [2026-02-09 11:37 MST] Issue #470 | Commit 0bc472a | closed | Added bridge identity preamble injection on first dispatch with compact whoami default, deterministic full fallback, per-session identity metadata, and display-label formatting/assignment | Tests: npm run test:bridge; npx tsx --test bridge/openclaw-bridge.test.ts bridge/__tests__/openclaw-bridge.activity-buffer.test.ts bridge/__tests__/openclaw-bridge.activity-delta.test.ts (fails: pre-existing missing vitest module)
- [2026-02-09 11:37 MST] Issue #470 | Commit 0bc472a | pushed | Pushed bridge identity injection implementation and posted closure evidence on GitHub issue #470 | Tests: npm run test:bridge
- [2026-02-09 11:42 MST] Issue #471 | Commit 758bcc8 | closed | Added bridge execution-mode resolver, deterministic project worktree roots, traversal/symlink path guards, first-dispatch execution policy injection, and session cwd metadata assignment for project mode | Tests: npm run test:bridge; npx tsx --test bridge/openclaw-bridge.test.ts bridge/__tests__/openclaw-bridge.activity-delta.test.ts; go test ./internal/api -run 'Test(ProjectChat|Issue|Message)Dispatch.*project_id' -count=1 (pass, no tests to run)
- [2026-02-09 11:42 MST] Issue #471 | Commit 758bcc8 | pushed | Pushed execution-mode/worktree/path-guard implementation and posted closure evidence on GitHub issue #471 | Tests: npm run test:bridge; npx tsx --test bridge/openclaw-bridge.test.ts bridge/__tests__/openclaw-bridge.activity-delta.test.ts
- [2026-02-09 11:57 MST] Issue #472 | Commit b3acb4f | closed | Added completion metadata capture across bridge ingest, agent activity persistence, timeline `activity_log` upsert, websocket payloads, and frontend parsing with idempotent upsert + cross-org conflict guard | Tests: go test ./internal/store/agent_activity_event_store.go ./internal/store/agent_activity_event_store_test.go ./internal/store/store.go ./internal/store/test_helpers_test.go -run 'TestAgentActivityEventStore(BatchCreateIdempotentCompletionMetadata|BatchCreateRejectsCrossOrgIDConflict|BatchCreate|Create)' -count=1; go test ./internal/api -run 'TestActivityEvents(IngestCompletionMetadataUpsert|IngestHandlerValidation|EventWebsocketBroadcast)' -count=1; npm run test:bridge; npx tsx --test bridge/openclaw-bridge.test.ts bridge/__tests__/openclaw-bridge.activity-delta.test.ts; cd web && npm run test -- --run src/hooks/useAgentActivity.test.ts; go test ./internal/store -run 'TestProjectCommitStore' -count=1 (fails: pre-existing internal/store/project_issue_store_test compile errors); go test ./internal/api -count=1 (fails: pre-existing route tests)
- [2026-02-09 11:57 MST] Issue #472 | Commit b3acb4f | pushed | Pushed completion metadata implementation and posted closure evidence on GitHub issue #472 | Tests: npm run test:bridge; go test ./internal/api -run 'TestActivityEvents(IngestCompletionMetadataUpsert|IngestHandlerValidation|EventWebsocketBroadcast)' -count=1
- [2026-02-09 12:05 MST] Issue #473 | Commit 474333c | closed | Added legacy workspace import on OpenClaw config sync (SOUL/IDENTITY/AGENTS/TOOLS/MEMORY + daily memory), idempotent agent/memory upserts, per-workspace partial recovery, and retired-workspace `LEGACY_TRANSITION.md` + AGENTS pointer generation | Tests: go test ./internal/api -run 'Test(OpenClawMigrationExtractWorkspaceDescriptors|LegacyTransitionEnsureFilesIdempotent|OpenClawSyncProgressLogEmissions)' -count=1; go test ./internal/api -run 'Test(OpenClawMigration|LegacyTransition)' -count=1 -v (DB-backed tests skipped without OTTER_TEST_DATABASE_URL); go test ./internal/store -run 'TestAgentMemory' -count=1 (fails: pre-existing internal/store/project_issue_store_test compile errors)
- [2026-02-09 12:05 MST] Issue #473 | Commit 474333c | pushed | Pushed legacy workspace import + transition generation implementation and posted closure evidence on GitHub issue #473 | Tests: go test ./internal/api -run 'Test(OpenClawMigrationExtractWorkspaceDescriptors|LegacyTransitionEnsureFilesIdempotent)' -count=1
- [2026-02-09 12:15 MST] Issue #474 | Commit 4323a3e | closed | Added OpenClaw config cutover/rollback safeguards: primary+chameleon reducer, checkpoint hash persistence/validation, admin config cutover+rollback API routes, and bridge `config.cutover`/`config.rollback` execution with hash-gated rollback | Tests: go test ./internal/api -run 'Test(OpenClawConfigCutover|OpenClawRollback)' -count=1; npx tsx --test bridge/__tests__/openclaw-bridge.admin-command.test.ts; npm run test:bridge; go test ./internal/api -run 'Test(RouterFeedEndpointUsesV2Handler|ProjectsAndInboxRoutesAreRegistered)' -count=1 (fails: pre-existing route test failures)
- [2026-02-09 12:15 MST] Issue #474 | Commit 4323a3e | pushed | Pushed config cutover/rollback implementation and posted closure evidence on GitHub issue #474 | Tests: go test ./internal/api -run 'Test(OpenClawConfigCutover|OpenClawRollback)' -count=1; npx tsx --test bridge/__tests__/openclaw-bridge.admin-command.test.ts
- [2026-02-09 12:25 MST] Issue #475 | Commit d4b1bb0 | closed | Added managed frontend identity/memory UX: editable identity save via Agent Files project commits, API-backed memory write/list flows, and explicit chameleon routing copy/payload updates in Agents/Connections | Tests: cd web && npm run test -- --run src/pages/AgentDetailPage.test.tsx src/pages/AgentsPage.test.tsx src/pages/ConnectionsPage.test.tsx src/components/agents/AddAgentModal.test.tsx src/components/agents/AgentIdentityEditor.test.tsx src/components/agents/AgentMemoryBrowser.test.tsx
- [2026-02-09 12:25 MST] Issue #475 | Commit d4b1bb0 | pushed | Pushed frontend managed identity/memory and chameleon UX updates and posted closure evidence on GitHub issue #475 | Tests: cd web && npm run test -- --run src/pages/AgentDetailPage.test.tsx src/pages/AgentsPage.test.tsx src/pages/ConnectionsPage.test.tsx src/components/agents/AddAgentModal.test.tsx src/components/agents/AgentIdentityEditor.test.tsx src/components/agents/AgentMemoryBrowser.test.tsx
- [2026-02-09 12:38 MST] Issue #476 | Commit ed83deb | closed | Added Spec 110 release-gate endpoint with category pass/fail output, cutover fail-closed enforcement, and CLI/client release-gate entrypoint (`otter release-gate`, `make release-gate`) | Tests: go test ./internal/api -run 'Test(AdminConfigReleaseGate|AdminConfigCutoverBlockedWhenReleaseGateFails|AdminConfigReleaseGatePassesAndCutoverDispatches|Spec110Gate)' -count=1; go test ./cmd/otter -run 'Test(ReleaseGatePayloadOK|DeriveManagedRepoURL|FriendlyAuthErrorMessage)' -count=1; go test ./internal/ottercli/client.go ./internal/ottercli/config.go ./internal/ottercli/client_release_gate_test.go -run 'TestRunReleaseGate' -count=1; npx tsx --test bridge/openclaw-bridge.test.ts bridge/__tests__/openclaw-bridge.admin-command.test.ts; npm run test:bridge; cd web && npm run test -- --run src/pages/AgentDetailPage.test.tsx
- [2026-02-09 12:38 MST] Issue #476 | Commit ed83deb | pushed | Pushed release-gate implementation to origin/codex/spec-110-chameleon-agent-architecture and closed GitHub issue #476 with commit/test evidence | Tests: same as prior entry
- [2026-02-09 12:38 MST] Issue #n/a | Commit n/a | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after completing planned issues #465-#476 | Tests: n/a
- [2026-02-09 17:01 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for reviewer-required follow-up and started branch codex/spec-110-chameleon-agent-architecture-r2 from origin/codex/spec-110-chameleon-agent-architecture due existing worktree lock | Tests: n/a
- [2026-02-09 17:03 MST] Issue #520 | Commit n/a | created | Planned rebase/conflict-resolution pre-merge gate issue with explicit full-gate tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #521 | Commit n/a | created | Planned bridge policy-level enforcement documentation + policy text tests issue | Tests: n/a
- [2026-02-09 17:03 MST] Issue #522 | Commit n/a | created | Planned UTF-8 rune-safe `capWhoAmIText` truncation issue with multibyte regression tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #523 | Commit n/a | created | Planned router duplicate-settings-route removal + single-registration test issue | Tests: n/a
- [2026-02-09 17:03 MST] Issue #524 | Commit n/a | created | Planned websocket secret log redaction issue with bridge tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #525 | Commit n/a | created | Planned atomic config-write hardening issue with failure-preservation tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #526 | Commit n/a | created | Planned sync re-entrancy guard issue with concurrency serialization tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #527 | Commit n/a | created | Planned partial unique daily memory index issue with store duplicate rejection tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #528 | Commit n/a | created | Planned OpenClaw websocket reconnect/backoff reliability issue with reconnect tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #529 | Commit n/a | created | Planned `rows.Err()` iteration-check issue for `loadSessions` with error-path tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #530 | Commit n/a | created | Planned websocket-secret env var resolution normalization issue with precedence tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #531 | Commit n/a | created | Planned canonical UUID regex tightening issue for activity IDs with invalid-format tests | Tests: n/a
- [2026-02-09 17:03 MST] Issue #532 | Commit n/a | created | Planned typed-error migration for `CreateMemory` status mapping with regression tests | Tests: n/a
- [2026-02-09 17:07 MST] Issue #520 | Commit 8de5b0e | closed | Rebased spec-110 stack onto latest main, resolved merge conflicts (`bridge/openclaw-bridge.ts`, `internal/api/openclaw_sync_test.go`, `internal/api/settings.go`, `web/src/pages/AgentDetailPage.test.tsx`, `web/src/pages/ConnectionsPage.test.tsx`) and passed full pre-merge gate | Tests: go build ./...; go vet ./...; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 17:07 MST] Issue #520 | Commit 8de5b0e | pushed | Pushed rebased stack to `origin/codex/spec-110-chameleon-agent-architecture-r2` (new branch required because force-update of existing PR branch is blocked in executor policy) and linked evidence on issue #520 | Tests: go build ./...; go vet ./...; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 17:07 MST] Issue #n/a | Commit n/a | in_progress | Opened PR #533 (`codex/spec-110-chameleon-agent-architecture-r2` -> `main`) to supersede PR #477 for reviewer visibility | Tests: n/a
- [2026-02-09 17:10 MST] Issue #521 | Commit 797c99d | closed | Documented v1 policy-level execution enforcement limits (bridge + spec), removed misleading no-op path guard call, added TOCTOU TODO notes, and locked execution policy block text assertions for conversation/project modes | Tests: npm run test:bridge
- [2026-02-09 17:10 MST] Issue #521 | Commit 797c99d | pushed | Pushed policy-level enforcement clarification/tests to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #521 | Tests: npm run test:bridge
- [2026-02-09 17:14 MST] Issue #522 | Commit f262f11 | closed | Converted `capWhoAmIText` truncation to rune-safe slicing and added emoji/CJK regression coverage to keep whoami output valid UTF-8 | Tests: go test ./internal/api -run 'Test(CapWhoAmITextIsRuneSafe|AgentWhoAmI)' -count=1
- [2026-02-09 17:14 MST] Issue #522 | Commit f262f11 | pushed | Pushed UTF-8 truncation fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #522 | Tests: go test ./internal/api -run 'Test(CapWhoAmITextIsRuneSafe|AgentWhoAmI)' -count=1
- [2026-02-09 17:12 MST] Issue #523 | Commit aa99832 | closed | Removed duplicate settings route registration block, kept one OptionalWorkspace-protected settings block (including API-key routes), and added router walk test to lock one registration per settings endpoint | Tests: go test ./internal/api -run 'TestSettingsRoutesAreRegisteredExactlyOnce' -count=1; go test ./internal/api -run 'TestSettings' -count=1
- [2026-02-09 17:12 MST] Issue #523 | Commit aa99832 | pushed | Pushed settings-route dedupe fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #523 | Tests: go test ./internal/api -run 'TestSettingsRoutesAreRegisteredExactlyOnce' -count=1; go test ./internal/api -run 'TestSettings' -count=1
- [2026-02-09 17:16 MST] Issue #524 | Commit acde518 | closed | Redacted websocket secret from OtterCamp connect logs by sanitizing logged WS URLs and added regression test ensuring token stays in URL builder output but never in log text | Tests: npm run test:bridge
- [2026-02-09 17:16 MST] Issue #524 | Commit acde518 | pushed | Pushed websocket log-redaction fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #524 | Tests: npm run test:bridge
- [2026-02-09 17:19 MST] Issue #525 | Commit 3cfbeda | closed | Switched OpenClaw config writes to temp-file + rename atomic flow with temp cleanup on failure and added regression test proving original config remains intact when rename fails | Tests: npx tsx --test bridge/__tests__/openclaw-bridge.admin-command.test.ts; npm run test:bridge
- [2026-02-09 17:19 MST] Issue #525 | Commit 3cfbeda | pushed | Pushed atomic config-write hardening to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #525 | Tests: npx tsx --test bridge/__tests__/openclaw-bridge.admin-command.test.ts; npm run test:bridge
- [2026-02-09 17:22 MST] Issue #526 | Commit 4aa3dda | closed | Added periodic sync re-entrancy guard so overlapping interval ticks are skipped while a prior run is active, with regression test proving serialized behavior and guard reset | Tests: npm run test:bridge
- [2026-02-09 17:22 MST] Issue #526 | Commit 4aa3dda | pushed | Pushed periodic sync serialization fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #526 | Tests: npm run test:bridge
- [2026-02-09 17:24 MST] Issue #527 | Commit 0732245 | closed | Added migration 051 partial unique index to enforce one daily memory per agent/date and added store-level duplicate-daily regression test | Tests: go test ./internal/store -run 'TestAgentMemoryStoreRejectsDuplicateDailyEntryForSameDate|TestAgentMemoryStoreCreateListSearch|TestAgentMemoryStoreRejectsInvalidAgentID' -count=1; go test ./internal/api -run 'TestAgentMemory' -count=1
- [2026-02-09 17:24 MST] Issue #527 | Commit 0732245 | pushed | Pushed daily-memory uniqueness index/test changes to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #527 | Tests: go test ./internal/store -run 'TestAgentMemoryStoreRejectsDuplicateDailyEntryForSameDate|TestAgentMemoryStoreCreateListSearch|TestAgentMemoryStoreRejectsInvalidAgentID' -count=1; go test ./internal/api -run 'TestAgentMemory' -count=1
- [2026-02-09 17:28 MST] Issue #528 | Commit 6a20b94 | closed | Added explicit OpenClaw websocket close-path reconnect test coverage by refactoring close handling into shared helper/test hooks and asserting reconnect callback attempt in continuous mode | Tests: npm run test:bridge
- [2026-02-09 17:28 MST] Issue #528 | Commit 6a20b94 | pushed | Pushed OpenClaw reconnect regression coverage to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #528 | Tests: npm run test:bridge
- [2026-02-09 17:31 MST] Issue #529 | Commit cf1ef30 | closed | Added explicit `rows.Err()` propagation for admin session loading (no silent partial lists), refactored session scan helper to return errors, and added fake-row iterator test for error path | Tests: go test ./internal/api -run 'TestScanAdminConnectionSessionsReturnsRowsErr|TestAdminConnectionsGetReturnsDiagnosticsAndSessionSummary|TestAdminConnectionsGetHandlesMissingDiagnosticsMetadata' -count=1
- [2026-02-09 17:31 MST] Issue #529 | Commit cf1ef30 | pushed | Pushed `loadSessions` rows.Err handling fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #529 | Tests: go test ./internal/api -run 'TestScanAdminConnectionSessionsReturnsRowsErr|TestAdminConnectionsGetReturnsDiagnosticsAndSessionSummary|TestAdminConnectionsGetHandlesMissingDiagnosticsMetadata' -count=1
- [2026-02-09 17:34 MST] Issue #530 | Commit 20312af | closed | Normalized websocket secret env resolution by preferring `OPENCLAW_WS_SECRET` with fallback to legacy `OTTERCAMP_WS_SECRET`, updated warning copy, and added precedence/fallback tests | Tests: npm run test:bridge
- [2026-02-09 17:34 MST] Issue #530 | Commit 20312af | pushed | Pushed env-resolution normalization to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #530 | Tests: npm run test:bridge
- [2026-02-09 17:37 MST] Issue #531 | Commit b89a043 | closed | Tightened activity UUID validation to canonical 8-4-4-4-12 regex and added regression tests for non-canonical 36-char strings | Tests: go test ./internal/api -run 'TestActivityUUIDRegexRequiresCanonicalShape|TestActivityEventsIngestHandler' -count=1
- [2026-02-09 17:37 MST] Issue #531 | Commit b89a043 | pushed | Pushed canonical UUID validation fix to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #531 | Tests: go test ./internal/api -run 'TestActivityUUIDRegexRequiresCanonicalShape|TestActivityEventsIngestHandler' -count=1
- [2026-02-09 17:40 MST] Issue #532 | Commit 0156b63 | closed | Replaced `CreateMemory` error string matching with typed store sentinel errors + `errors.Is` mapping and added tests proving bad-request mapping survives wrapped message wording changes | Tests: go test ./internal/api -run 'TestMapCreateMemoryErrorUsesTypedErrors|TestAgentMemoryCreateUsesTypedValidationErrors' -count=1; go test ./internal/store -run 'TestAgentMemoryStoreRejectsInvalidAgentID' -count=1; go test ./internal/api -run 'TestAgentMemory' -count=1
- [2026-02-09 17:40 MST] Issue #532 | Commit 0156b63 | pushed | Pushed typed memory error mapping changes to `origin/codex/spec-110-chameleon-agent-architecture-r2` and posted close evidence on issue #532 | Tests: go test ./internal/api -run 'TestMapCreateMemoryErrorUsesTypedErrors|TestAgentMemoryCreateUsesTypedValidationErrors' -count=1; go test ./internal/store -run 'TestAgentMemoryStoreRejectsInvalidAgentID' -count=1; go test ./internal/api -run 'TestAgentMemory' -count=1
- [2026-02-09 17:41 MST] Issue #520-#532 | Commit 0156b63 | resolved | Completed all reviewer-required fixes (pre-merge rebase gate, P1/P2/P3 items), removed top-level `## Reviewer Required Changes` block per process, and preserved implementation evidence in append-only execution log entries | Tests: go build ./...; go vet ./...; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 17:41 MST] Issue #n/a | Commit n/a | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after closing issues #520-#532 and updating PR #533 with passing gate evidence | Tests: go build ./...; go vet ./...; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 18:42 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for new reviewer-required follow-up cycle and created branch `codex/spec-110-chameleon-agent-architecture-r3` from `origin/codex/spec-110-chameleon-agent-architecture-r2` | Tests: n/a
- [2026-02-09 18:43 MST] Issue #550 | Commit n/a | created | Planned P3 out-of-scope follow-up tracker for `openclaw_sync.go` package-level race-condition hardening with explicit `-race` test commands | Tests: n/a (issue creation)
- [2026-02-09 18:43 MST] Issue #551 | Commit n/a | created | Planned P2 fix to remove hardcoded "Agent Files" project-name dependency from AgentIdentityEditor save flow with explicit frontend test commands | Tests: n/a (issue creation)
- [2026-02-09 18:43 MST] Issue #552 | Commit n/a | created | Planned P3 fix to cancel AgentMemoryBrowser in-flight requests on unmount with explicit frontend test commands | Tests: n/a (issue creation)
- [2026-02-09 18:44 MST] Issue #547/#548/#549 | Commit n/a | closed | Closed malformed duplicate issues (created by shell quoting error) as superseded by clean replacements #552/#551/#550 to keep spec-110 micro-issue queue canonical | Tests: n/a
- [2026-02-09 18:44 MST] Issue #541-#546/#550-#552 | Commit n/a | planned | Verified full reviewer-required micro-issue set exists before coding (P0: migration collision; P1: auth fetches/CLI role/LIKE escape; P2: bounds + editor state + project-ID dependency; P3: unmount cancellation + race follow-up tracker) | Tests: gh issue list --state open --repo samhotchkiss/otter-camp
- [2026-02-09 18:47 MST] Issue #541 | Commit 168acb1 | closed | Renumbered spec-110 migrations to 053-056 and restored mainline 050/051/052 migration files to eliminate collision/deletion risk | Tests: scripts/check-migrations.sh; go build ./...; go test ./... (known unrelated route-test failures)
- [2026-02-09 18:47 MST] Issue #541 | Commit 168acb1 | pushed | Pushed migration-collision fix to `origin/codex/spec-110-chameleon-agent-architecture-r3` and closed issue with commit/test evidence | Tests: scripts/check-migrations.sh; go build ./...
- [2026-02-09 18:50 MST] Issue #542 | Commit 3c54916 | closed | Replaced agent-component raw fetch usage with `apiFetch` and added header assertions in component tests | Tests: cd web && npx vitest run src/components/agents/AddAgentModal.test.tsx src/components/agents/AgentMemoryBrowser.test.tsx src/components/agents/AgentIdentityEditor.test.tsx; cd web && npx vitest run
- [2026-02-09 18:50 MST] Issue #542 | Commit 3c54916 | pushed | Pushed authenticated frontend API-call fix and posted closure evidence on issue #542 | Tests: cd web && npx vitest run
- [2026-02-09 18:52 MST] Issue #543 | Commit 5b1c2a6 | closed | Added `buildAgentCreatePayload` path so CLI forwards non-empty `--role` into agent-create API payload with regression coverage | Tests: go test ./cmd/otter -run TestBuildAgentCreatePayload -count=1; go test ./internal/ottercli -run TestAgentClientMethodsUseExpectedPathsAndPayloads -count=1; go test ./cmd/otter ./internal/ottercli -count=1
- [2026-02-09 18:52 MST] Issue #543 | Commit 5b1c2a6 | pushed | Pushed CLI role-propagation fix and posted closure evidence on issue #543 | Tests: go test ./cmd/otter ./internal/ottercli -count=1
- [2026-02-09 18:53 MST] Issue #544 | Commit c79934b | closed | Escaped LIKE metacharacters for memory search (`ILIKE ... ESCAPE '\\'`) and added wildcard-escape regression coverage | Tests: go test ./internal/store -run 'TestEscapeLikePattern|TestAgentMemoryStoreCreateListSearch|TestAgentMemoryStoreSearchEscapesLikeWildcards' -count=1; go test ./internal/store -count=1
- [2026-02-09 18:53 MST] Issue #544 | Commit c79934b | pushed | Pushed LIKE wildcard-escape fix and posted closure evidence on issue #544 | Tests: go test ./internal/store -count=1
- [2026-02-09 18:55 MST] Issue #545 | Commit 6cf4e02 | closed | Added API-layer caps/defaults for memory `days` and `limit` query params and added clamp regression tests | Tests: go test ./internal/api -run 'TestParseMemoryDaysParamClampsLargeValues|TestParseMemorySearchLimitParamClampsLargeValues|TestAgentMemory' -count=1
- [2026-02-09 18:55 MST] Issue #545 | Commit 6cf4e02 | pushed | Pushed memory parameter clamping changes and posted closure evidence on issue #545 | Tests: go test ./internal/api -run 'TestParseMemoryDaysParamClampsLargeValues|TestParseMemorySearchLimitParamClampsLargeValues|TestAgentMemory' -count=1
- [2026-02-09 18:57 MST] Issue #546 | Commit 6ddc021 | closed | Removed DOM `querySelector` dependency from identity save path, used React state directly, and cleared `saveMessage` on file switch with tests | Tests: cd web && npx vitest run src/components/agents/AgentIdentityEditor.test.tsx; cd web && npx vitest run
- [2026-02-09 18:57 MST] Issue #546 | Commit 6ddc021 | pushed | Pushed identity-editor state-driven save fix and posted closure evidence on issue #546 | Tests: cd web && npx vitest run
- [2026-02-09 19:02 MST] Issue #551 | Commit 1a3a3d0 | closed | Removed hardcoded "Agent Files" name lookup by returning/storing `project_id` from admin files API and using it for save commits | Tests: go test ./internal/api -run 'TestAdminAgentFiles' -count=1; cd web && npx vitest run src/components/agents/AgentIdentityEditor.test.tsx; cd web && npx vitest run
- [2026-02-09 19:02 MST] Issue #551 | Commit 1a3a3d0 | pushed | Pushed project-ID based identity save flow and posted closure evidence on issue #551 | Tests: go test ./internal/api -run 'TestAdminAgentFiles' -count=1; cd web && npx vitest run
- [2026-02-09 19:02 MST] Issue #552 | Commit d59297a | closed | Added AbortController cancellation for memory-load requests on unmount and regression test to prevent post-unmount state updates | Tests: cd web && npx vitest run src/components/agents/AgentMemoryBrowser.test.tsx; cd web && npx vitest run
- [2026-02-09 19:02 MST] Issue #552 | Commit d59297a | pushed | Pushed memory-browser unmount-cancellation fix and posted closure evidence on issue #552 | Tests: cd web && npx vitest run
- [2026-02-09 19:04 MST] Issue #541-#546/#551/#552 | Commit d59297a | resolved | Completed all reviewer-required implementation items from top-level block; retained #550 as explicit out-of-scope follow-up tracker for pre-existing openclaw sync race hardening | Tests: go build ./...; go test ./cmd/otter ./internal/ottercli ./internal/store ./internal/api -count=1; cd web && npx vitest run
- [2026-02-09 19:04 MST] Issue #n/a | Commit n/a | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after reviewer-required fixes closed and pushed on branch `codex/spec-110-chameleon-agent-architecture-r3` | Tests: n/a
- [2026-02-09 20:16 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for reviewer-required follow-up cycle R4 and switched to branch `codex/spec-110-chameleon-agent-architecture-r3` for rebase prep | Tests: n/a
- [2026-02-09 20:18 MST] Issue #570-#577 | Commit n/a | created | Created full reviewer-required R4 micro-issue set with explicit tests before coding (rebase gate + P0/P1/P2/P3 fixes) | Tests: gh issue create/list in samhotchkiss/otter-camp
- [2026-02-09 20:24 MST] Issue #570 | Commit n/a | closed | Rebased onto latest main, resolved merge conflicts, passed pre-merge gate (`go vet`, `go build`, `vitest`), pushed new branch `codex/spec-110-chameleon-agent-architecture-r4`, opened draft PR #579, and closed superseded PR #553 | Tests: go vet ./...; go build ./...; cd web && npx vitest run
- [2026-02-09 20:36 MST] Issue #571 | Commit ccd4fb9 | closed | Guarded OpenClaw memory fallback globals with `sync.RWMutex`, routed memory fallback reads through snapshot helpers, and added concurrent read/write race regression coverage | Tests: go test ./internal/api -run TestOpenClawSyncMemoryFallbackConcurrentReadWrite -count=1; go test -race ./internal/api/... -count=1
- [2026-02-09 20:36 MST] Issue #571 | Commit ccd4fb9 | pushed | Pushed data-race hardening changes to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run TestOpenClawSyncMemoryFallbackConcurrentReadWrite -count=1; go test -race ./internal/api/... -count=1
- [2026-02-09 20:39 MST] Issue #572 | Commit bdd4c5b | closed | Added 1MB `CreateMemory` request-body cap via `http.MaxBytesReader`, returned 413 on oversized payloads, and added decoder-level unit coverage for oversize/normal JSON bodies | Tests: go test ./internal/api -run 'TestDecodeCreateMemoryRequest(RejectsOversizedBody|AcceptsValidBody)' -count=1; go test ./internal/api -run 'Test(AgentMemoryCreateRejectsOversizedBody|AgentMemoryCreateReadAndSearch|AgentMemoryCreateUsesTypedValidationErrors|DecodeCreateMemoryRequestRejectsOversizedBody|DecodeCreateMemoryRequestAcceptsValidBody)' -count=1 -v
- [2026-02-09 20:39 MST] Issue #572 | Commit bdd4c5b | pushed | Pushed CreateMemory request-size limit changes to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run 'TestDecodeCreateMemoryRequest(RejectsOversizedBody|AcceptsValidBody)' -count=1
- [2026-02-09 20:43 MST] Issue #573 | Commit 52ab563 | closed | Persisted cutover checkpoint only after successful dispatch response, added buffered dispatch-response capture in `Cutover`, and added regression coverage for no-checkpoint-on-undelivered dispatch plus checkpoint-on-success | Tests: go test ./internal/api -run 'TestAdminConfig(CutoverDoesNotPersistCheckpointWhenDispatchNotDelivered|ReleaseGatePassesAndCutoverDispatches)' -count=1 -v; go test ./internal/api -run 'Test(OpenClawRollbackHashValidationChecksCanonicalConfig|AdminConfigCutoverBlockedWhenReleaseGateFails)' -count=1 -v
- [2026-02-09 20:43 MST] Issue #573 | Commit 52ab563 | pushed | Pushed cutover-checkpoint atomicity fix to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run 'TestAdminConfig(CutoverDoesNotPersistCheckpointWhenDispatchNotDelivered|ReleaseGatePassesAndCutoverDispatches)' -count=1 -v
- [2026-02-09 20:45 MST] Issue #574 | Commit 0db4260 | closed | Added explicit query/scan logging in `listWhoAmIActiveTasks`, introduced `scanWhoAmIActiveTasks` with strict scan + `rows.Err()` error propagation, and added unit coverage for query log path + row error paths | Tests: go test ./internal/api -run 'Test(ScanWhoAmIActiveTasksReturnsScanError|ScanWhoAmIActiveTasksReturnsRowsErr|ListWhoAmIActiveTasksLogsQueryError)' -count=1 -v; go test ./internal/api -run 'Test(AgentWhoAmI|CapWhoAmITextIsRuneSafe|ScanWhoAmIActiveTasks|ListWhoAmIActiveTasksLogsQueryError)' -count=1 -v
- [2026-02-09 20:45 MST] Issue #574 | Commit 0db4260 | pushed | Pushed whoami active-task error-handling hardening to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run 'Test(ScanWhoAmIActiveTasksReturnsScanError|ScanWhoAmIActiveTasksReturnsRowsErr|ListWhoAmIActiveTasksLogsQueryError)' -count=1 -v
- [2026-02-09 20:46 MST] Issue #575 | Commit 6daa74b | closed | Aligned API memory query caps with store behavior by lowering API max clamps to `days=30` and `limit=100`, and updated clamp tests to assert aligned limits (`days=60`, `limit=200` inputs) | Tests: go test ./internal/api -run 'TestParseMemory(DaysParamClampsLargeValues|SearchLimitParamClampsLargeValues)' -count=1; go test ./internal/api -run 'Test(DecodeCreateMemoryRequestRejectsOversizedBody|DecodeCreateMemoryRequestAcceptsValidBody|ParseMemoryDaysParamClampsLargeValues|ParseMemorySearchLimitParamClampsLargeValues)' -count=1
- [2026-02-09 20:46 MST] Issue #575 | Commit 6daa74b | pushed | Pushed API/store memory-cap alignment to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run 'TestParseMemory(DaysParamClampsLargeValues|SearchLimitParamClampsLargeValues)' -count=1
- [2026-02-09 20:48 MST] Issue #576 | Commit 717e953 | closed | Moved legacy transition file generation to post-commit flow in workspace import, prevented `LEGACY_TRANSITION.md` overwrite when file exists, and added commit-failure + idempotency regression coverage | Tests: go test ./internal/api -run 'Test(LegacyTransitionEnsureFilesIdempotent|OpenClawMigrationCommitFailureDoesNotGenerateTransitionFiles)' -count=1 -v; go test ./internal/api -run 'Test(OpenClawMigrationImportsLegacyWorkspacesIdempotent|LegacyTransitionFileGenerationPrependsAgentsPointerIdempotent|LegacyTransitionEnsureFilesIdempotent)' -count=1 -v
- [2026-02-09 20:48 MST] Issue #576 | Commit 717e953 | pushed | Pushed legacy transition idempotency/ordering fixes to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: go test ./internal/api -run 'Test(LegacyTransitionEnsureFilesIdempotent|OpenClawMigrationCommitFailureDoesNotGenerateTransitionFiles)' -count=1 -v
- [2026-02-09 20:51 MST] Issue #577 | Commit f76e72c | closed | Hardened malformed websocket URL logging fallback, tightened CLI `issueUUIDPattern` to canonical UUID shape, and added AbortController cancellation for AgentIdentityEditor identity fetch flows with unmount regression coverage | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts; go test ./cmd/otter -run 'Test(ResolveIssueIDUUIDBypassesLookup|IssueUUIDPatternRequiresCanonicalShape)' -count=1; cd web && npx vitest run src/components/agents/AgentIdentityEditor.test.tsx
- [2026-02-09 20:51 MST] Issue #577 | Commit f76e72c | pushed | Pushed bundled minor reviewer fixes to `origin/codex/spec-110-chameleon-agent-architecture-r4` and closed issue with commit/test evidence | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts; go test ./cmd/otter -run 'Test(ResolveIssueIDUUIDBypassesLookup|IssueUUIDPatternRequiresCanonicalShape)' -count=1; cd web && npx vitest run src/components/agents/AgentIdentityEditor.test.tsx
- [2026-02-09 20:51 MST] Issue #550 | Commit n/a | updated | Re-scoped follow-up tracker to cover v1 bridge policy-level write-guard hardening (write-hook enforcement + symlink/TOCTOU checks) and verified reviewer-required known-gap tracking requirement is satisfied | Tests: gh issue edit/view/comment #550
- [2026-02-09 20:51 MST] Issue #570-#577/#550 | Commit f76e72c | resolved | Completed all reviewer-required R4 implementation items, preserved known v1 bridge write-guard limitation as explicit follow-up in #550, and removed top-level `## Reviewer Required Changes` block per process | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run src/components/agents/AgentIdentityEditor.test.tsx
- [2026-02-09 20:53 MST] Issue #570-#577 | Commit f76e72c | validated | Re-ran full post-fix gate on the R4 branch and confirmed all required backend/bridge/frontend suites are green | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 20:54 MST] Issue #n/a | Commit n/a | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after closing reviewer cycle R4 issues #570-#577 and reconciling known v1 follow-up tracking in issue #550 | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:01 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for reviewer-required follow-up cycle R5 on branch codex/spec-110-chameleon-agent-architecture-r4 | Tests: n/a
- [2026-02-09 21:01 MST] Issue #581 | Commit n/a | created | Planned reviewer-required R5 rebase/conflict-resolution work unit with explicit full-gate tests before implementation | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:06 MST] Issue #581 | Commit be29671 | closed | Rebased spec-110 R4 branch onto latest origin/main, resolved reviewer-required conflicts in `internal/api/router.go`, `cmd/otter/main_test.go`, and `internal/api/router_test.go`, and passed full pre-merge gate | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:06 MST] Issue #581 | Commit be29671 | pushed | Force-updated `origin/codex/spec-110-chameleon-agent-architecture-r4` after rebase and posted closure evidence on GitHub issue #581 | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:06 MST] Issue #581 | Commit be29671 | resolved | Removed resolved top-level `## Reviewer Required Changes` block for R5 and preserved completion evidence in append-only execution log | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:06 MST] Issue #n/a | Commit n/a | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after completing reviewer-required R5 rebase/conflict gate | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:07 MST] Issue #580 | Commit be29671 | closed | Reconciled GitHub/local state by closing duplicate reviewer task issue #580 as completed by the same R5 rebase/conflict-resolution work (issue #581 tracked as execution duplicate) | Tests: go vet ./...; go build ./...; git merge main --no-commit --no-ff; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:16 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for reviewer-required follow-up cycle R6 on branch `codex/spec-110-chameleon-agent-architecture-r4` | Tests: n/a
- [2026-02-09 21:17 MST] Issue #582-#586 | Commit n/a | updated | Normalized reviewer micro-issue bodies to include explicit scope/checklist/test-plan/acceptance criteria before implementation | Tests: gh issue edit/view #582 #583 #584 #585 #586
- [2026-02-09 21:17 MST] Issue #588/#589/#590 | Commit n/a | created | Split bundled P2 work from #587 into three atomic micro-issues with explicit command-level tests | Tests: gh issue create #588 #589 #590
- [2026-02-09 21:18 MST] Issue #587 | Commit n/a | closed | Closed bundled issue #587 as superseded by #588/#589/#590 to keep one-behavior-per-issue sizing | Tests: gh issue comment/close #587
- [2026-02-09 21:19 MST] Issue #582 | Commit 97886e2 | pushed | Added `agent_memories` RLS enable/force + org-isolation policy and DB-level cross-org read/write isolation tests in store suite | Tests: go test ./internal/store -run 'Test(RLSEnabled|AgentMemoriesRLSBlocksCrossOrgReadAndWrite)' -count=1 -v (skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/store -count=1
- [2026-02-09 21:20 MST] Issue #583 | Commit 4d34682 | pushed | Added `update_agent_memories_updated_at` trigger in migration 054 and store regression test asserting `updated_at` advances on UPDATE | Tests: go test ./internal/store -run 'TestAgentMemoryStoreUpdateAdvancesUpdatedAt' -count=1 -v (skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/store -count=1
- [2026-02-09 21:21 MST] Issue #584 | Commit 20204ef | pushed | Replaced unsynchronized store lazy-init with `sync.Once` and added concurrent resolveStore race regression test | Tests: go test ./internal/api -run TestAgentActivityResolveStoreConcurrent -count=1; go test -race ./internal/api -run TestAgentActivityResolveStoreConcurrent -count=1; go test -race ./internal/api/... -count=1
- [2026-02-09 21:22 MST] Issue #585 | Commit 40f6e28 | pushed | Enforced non-empty `config_hash` requirement for `config.rollback` and added bridge regression test for missing-hash rejection | Tests: npx tsx --test bridge/__tests__/openclaw-bridge.admin-command.test.ts; npm run test:bridge
- [2026-02-09 21:24 MST] Issue #586 | Commit 3f553ce | pushed | Added legacy workspace path sanitization (`Clean`/`Abs`, traversal rejection, symlink rejection, `EvalSymlinks`) and tests for traversal/symlink path rejection | Tests: go test ./internal/api -run 'Test(LegacyTransitionEnsureFilesIdempotent|LegacyWorkspacePathValidationRejectsTraversalAndSymlink)' -count=1 -v; go test ./internal/api -run 'Test(OpenClawMigration|LegacyTransition)' -count=1 -v (DB-backed tests skipped); go test ./internal/api -count=1
- [2026-02-09 21:25 MST] Issue #588 | Commit 2a2bf03 | pushed | Updated migration 056 daily unique index to `(org_id, agent_id, date)` and added schema assertion for index definition | Tests: go test ./internal/store -run 'Test(SchemaAgentMemoriesDailyUniqueIndexIncludesOrgScope|AgentMemoryStoreRejectsDuplicateDailyEntryForSameDate)' -count=1 -v (skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/store -count=1
- [2026-02-09 21:26 MST] Issue #589 | Commit 394ec8a | pushed | Switched activity ingest sentinel checks to `errors.Is` and added wrapped-error regression coverage | Tests: go test ./internal/api -run 'Test(ActivityEventsIngestUsesErrorsIsForWorkspaceErrors|ActivityEventsIngestHandler)' -count=1 -v; go test ./internal/api -count=1
- [2026-02-09 21:27 MST] Issue #590 | Commit ce03532 | pushed | Switched legacy transition AGENTS/transition writes to atomic temp-file+rename flow and added failure-injection test preserving existing AGENTS content | Tests: go test ./internal/api -run 'Test(EnsureLegacyTransitionFilesAtomicWritePreservesAgentsOnFailure|LegacyTransitionEnsureFilesIdempotent)' -count=1 -v; go test ./internal/api -run 'Test(OpenClawMigration|LegacyTransition|EnsureLegacyTransitionFilesAtomicWritePreservesAgentsOnFailure)' -count=1 -v (DB-backed tests skipped); go test ./internal/api -count=1
- [2026-02-09 21:30 MST] Issue #582-#586/#587/#588-#590 | Commit ce03532 | resolved | Completed all reviewer-required R6 fixes, removed top-level `## Reviewer Required Changes` block, and preserved DB-test follow-up constraints in `issues/notes.md` | Tests: see issue-linked command logs and commits 97886e2/4d34682/20204ef/40f6e28/3f553ce/2a2bf03/394ec8a/ce03532
- [2026-02-09 21:30 MST] Issue #n/a | Commit ce03532 | validated | Passed final branch regression gate after R6 fixes | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 21:31 MST] Issue #n/a | Commit ce03532 | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after closing reviewer-required issues #582-#586 and #588-#590 | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run

- [2026-02-09 21:45 MST] Issue #n/a | Commit n/a | in_progress | Moved spec 110 from 01-ready to 02-in-progress for reviewer-required follow-up cycle R7 on branch `codex/spec-110-chameleon-agent-architecture-r4` | Tests: n/a
- [2026-02-09 21:47 MST] Issue #597 | Commit n/a | created | Planned P1 admin capability auth guards for admin config mutation routes with explicit auth/capability tests | Tests: go test ./internal/api -run 'TestAdminConfigMutationRoutesRequireAuthenticationAndAdminCapability' -count=1
- [2026-02-09 21:47 MST] Issue #598 | Commit n/a | created | Planned P1 admin config request-body MaxBytes limits with explicit 413 oversized-body tests | Tests: go test ./internal/api -run 'TestAdminConfigPatchRejectsOversizedBody|TestAdminConfig(ReleaseGate|Cutover|Rollback)RejectsOversizedBody' -count=1
- [2026-02-09 21:47 MST] Issue #599 | Commit n/a | created | Planned P1 UUID validation for sync workspace fallback headers/query with explicit 400 regression tests | Tests: go test ./internal/api -run 'TestOpenClawSyncRejectsNonUUIDWorkspaceIDFallback' -count=1
- [2026-02-09 21:47 MST] Issue #600 | Commit n/a | created | Planned P2 org-scoping for agent_sync_state schema/queries with admin connections isolation tests | Tests: go test ./internal/api -run 'TestAdminConnectionsGetReturnsWorkspaceScopedRows|TestAdminConnectionsGetEventsReturnsWorkspaceScopedRows' -count=1
- [2026-02-09 21:47 MST] Issue #601 | Commit n/a | created | Planned P2 memory search q-length cap at 500 with explicit over-limit 400 tests | Tests: go test ./internal/api -run 'TestAgentMemorySearchRejectsQueryOver500Chars' -count=1
- [2026-02-09 21:47 MST] Issue #602 | Commit n/a | created | Planned P2 canonical UUID validation for activity ListByAgent route param with 400 regression tests | Tests: go test ./internal/api -run 'TestAgentActivityListByAgentRejectsNonUUIDAgentID' -count=1
- [2026-02-09 21:47 MST] Issue #603 | Commit n/a | created | Planned P2 bridge fallback agent ID parser hardening to reject non-UUID extracted IDs with regression tests | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts
- [2026-02-09 21:47 MST] Issue #604 | Commit n/a | created | Planned P3 bridge execution-policy wording correction to avoid implying hard write-enforcement in v1 | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts
- [2026-02-09 21:47 MST] Issue #605 | Commit n/a | created | Planned P3 cutover checkpoint persistence on queued (202) dispatch with explicit checkpoint regression tests | Tests: go test ./internal/api -run 'TestAdminConfigCutoverPersistsCheckpointWhenDispatchQueued' -count=1
- [2026-02-09 21:47 MST] Issue #606 | Commit n/a | created | Planned P3 admin events GetEvents limit clamp at 200 with explicit handler tests | Tests: go test ./internal/api -run 'TestAdminConnectionsGetEventsClampsLimitTo200' -count=1
- [2026-02-09 21:47 MST] Issue #597-#606 | Commit n/a | planned | Verified full reviewer-required R7 micro-issue set exists before implementation | Tests: gh issue list --repo samhotchkiss/otter-camp --state open --search 'spec-110 R7'
- [2026-02-09 21:48 MST] Issue #591-#596 | Commit n/a | closed | Closed overlapping umbrella issues as superseded by canonical micro-issue set #597-#606 to preserve one-behavior-per-issue execution | Tests: gh issue view/close #591 #592 #593 #594 #595 #596
- [2026-02-09 21:51 MST] Issue #597 | Commit 3007cd1 | pushed | Added  capability and enforced  on all  mutation routes (including admin config), with route wiring + auth regression tests | Tests: go test ./internal/api -run 'Test(AdminConfigMutationRoutesRequireAuthenticationAndAdminCapability|AdminMutationRoutesRequireCapability|RoleAllowsCapabilityMatrix|RequireCapabilityAllowsExpectedRoles)' -count=1; go test ./internal/api -run 'TestAdminConfigMutationRoutesRequireAuthenticationAndAdminCapability' -count=1 -v (skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/api -run 'Test(RoleAllowsCapabilityMatrix|AdminMutationRoutesRequireCapability)' -count=1
- [2026-02-09 21:51 MST] Issue #597 | Commit 3007cd1 | closed | Closed issue with commit/test evidence (posted clean follow-up comment after shell-quoting corruption in initial close comment) | Tests: gh issue close/comment #597
- [2026-02-09 21:51 MST] Issue #597 | Commit 3007cd1 | corrected_log | Corrected prior malformed log text caused by shell command-substitution: capability=`admin.config.manage`; middleware=`RequireCapability(db, CapabilityAdminConfigManage)`; scope=all `/api/admin/*` mutation routes including `/api/admin/config/*` | Tests: go test ./internal/api -run 'Test(AdminConfigMutationRoutesRequireAuthenticationAndAdminCapability|AdminMutationRoutesRequireCapability|RoleAllowsCapabilityMatrix|RequireCapabilityAllowsExpectedRoles)' -count=1
- [2026-02-09 21:53 MST] Issue #598 | Commit 5835df0 | pushed | Added shared admin-config request decode helper with MaxBytesReader limits and enforced 413 oversized-body handling in Patch/ReleaseGate/Cutover/Rollback handlers; added four-handler oversized-body regression test | Tests: go test ./internal/api -run 'TestAdminConfig(MutationHandlersRejectOversizedBody|PatchValidatesPayload)' -count=1; go test ./internal/api -run 'TestAdminConfig' -count=1 -v (DB-backed tests skipped: OTTER_TEST_DATABASE_URL unset)
- [2026-02-09 21:53 MST] Issue #598 | Commit 5835df0 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #598
- [2026-02-09 21:55 MST] Issue #599 | Commit 0c85815 | pushed | Added canonical UUID validation for OpenClaw sync workspace ID fallback resolution (context/header/query) and returned 400 on invalid fallback IDs; added non-UUID fallback regression test | Tests: go test ./internal/api -run 'Test(RequireOpenClawSyncAuth_(NoSecretConfigured|MissingToken|ValidBearerToken|FallbackToWebhookSecret|BackwardCompatibleTokenVariable)|OpenClawSyncRejectsNonUUIDWorkspaceIDFallback)' -count=1; go test ./internal/api -run 'TestOpenClawSyncHandlePersistsDiagnosticsMetadata' -count=1 -v (skipped: OTTER_TEST_DATABASE_URL unset)
- [2026-02-09 21:55 MST] Issue #599 | Commit 0c85815 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #599
- [2026-02-09 22:02 MST] Issue #600 | Commit 67e5921 | pushed | Added migration 057 to org-scope agent_sync_state with composite key + RLS policy; updated sync upserts/admin connections/admin agents/messages DM lookup to include org scope; updated scoped fixtures/tests | Tests: go test ./internal/api -run 'Test(OpenClawSyncRejectsNonUUIDWorkspaceIDFallback|OpenClawSyncMemoryFallbackConcurrentReadWrite|AdminMutationRoutesRequireCapability|AdminConfigMutationHandlersRejectOversizedBody|AgentSyncStateSchemaIncludesOrgScopeAndRLS)' -count=1 -v; go test ./internal/api -run 'Test(AdminConnectionsGetReturnsDiagnosticsAndSessionSummary|AdminAgentsListReturnsMergedRoster|CreateMessageDMDispatchesToOpenClaw|AgentStatusConsistency|AdminConnectionsGetEventsReturnsWorkspaceScopedRows)' -count=1 -v (DB-backed tests skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/api -run TestDoesNotExist -count=1; go test ./internal/store -run TestNonExistent -count=1
- [2026-02-09 22:02 MST] Issue #600 | Commit 67e5921 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #600
- [2026-02-09 22:05 MST] Issue #601 | Commit 30352d4 | pushed | Enforced 500-character cap for memory search q parameter via validateMemorySearchQuery and returned 400 on over-limit input; added handler + boundary tests | Tests: go test ./internal/api -run 'Test(AgentMemorySearchRejectsQueryOver500Chars|ValidateMemorySearchQuery(RejectsOverLimit|AcceptsLimitBoundary)|ParseMemorySearchLimitParamClampsLargeValues)' -count=1; go test ./internal/api -run 'TestAgentMemory(CreateReadAndSearch|SearchRejectsQueryOver500Chars)' -count=1 -v (DB-backed TestAgentMemoryCreateReadAndSearch skipped: OTTER_TEST_DATABASE_URL unset)
- [2026-02-09 22:05 MST] Issue #601 | Commit 30352d4 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #601
- [2026-02-09 22:07 MST] Issue #602 | Commit 06488fc | pushed | Added canonical UUID validation to AgentActivityHandler.ListByAgent and returned 400 for non-UUID path IDs; added invalid-ID regression test | Tests: go test ./internal/api -run 'Test(AgentActivityListByAgentRejectsNonUUIDAgentID|AgentActivityListByAgentHandler)' -count=1; go test ./internal/api -run 'Test(AgentActivityListByAgentRejectsNonUUIDAgentID|AgentActivityListByAgentHandler|AgentTimelineEvents)' -count=1 -v (DB-backed tests skipped: OTTER_TEST_DATABASE_URL unset)
- [2026-02-09 22:07 MST] Issue #602 | Commit 06488fc | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #602
- [2026-02-09 22:08 MST] Issue #603 | Commit 64a1f58 | pushed | Hardened bridge fallback session-key agent parsing with safe-identifier validation, rejected malformed/path-like tokens, and added fallback parsing regression tests | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts; npx tsx --test bridge/openclaw-bridge.test.ts --test-name-pattern 'session key|parseAgentIDFromSessionKey|sanitizes fallback agent id extraction'
- [2026-02-09 22:08 MST] Issue #603 | Commit 64a1f58 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #603
- [2026-02-09 22:09 MST] Issue #604 | Commit 80494dc | pushed | Reworded bridge execution-policy security text to policy-contract language (path traversal/symlink escape SHOULD NOT be used) and updated policy text assertions | Tests: npm run test:bridge -- bridge/openclaw-bridge.test.ts; npx tsx --test bridge/openclaw-bridge.test.ts --test-name-pattern 'policy|traversal|symlink|execution mode'
- [2026-02-09 22:09 MST] Issue #604 | Commit 80494dc | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #604
- [2026-02-09 22:11 MST] Issue #605 | Commit 0318eec | pushed | Updated cutover checkpoint persistence to include queued dispatch path (HTTP 202) in addition to immediate dispatch success (HTTP 200); updated cutover regression test accordingly | Tests: go test ./internal/api -run 'TestAdminConfig(CutoverPersistsCheckpointWhenDispatchQueued|ReleaseGatePassesAndCutoverDispatches|CutoverBlockedWhenReleaseGateFails)' -count=1 -v (DB-backed tests skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/api -run 'TestAdminConfigMutationHandlersRejectOversizedBody' -count=1
- [2026-02-09 22:11 MST] Issue #605 | Commit 0318eec | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #605
- [2026-02-09 22:13 MST] Issue #606 | Commit 36fb879 | pushed | Added handler-level clamp in AdminConnectionsHandler.GetEvents so limit values above 200 are capped at 200; added explicit limit-clamp regression test | Tests: go test ./internal/api -run 'TestAdminConnectionsGetEvents(ClampsLimitTo200|ReturnsWorkspaceScopedRows)' -count=1 -v (DB-backed tests skipped: OTTER_TEST_DATABASE_URL unset); go test ./internal/api -run 'Test(AdminMutationRoutesRequireCapability|AgentMemorySearchRejectsQueryOver500Chars|OpenClawSyncRejectsNonUUIDWorkspaceIDFallback|AgentActivityListByAgentRejectsNonUUIDAgentID|AdminConfigMutationHandlersRejectOversizedBody)' -count=1
- [2026-02-09 22:13 MST] Issue #606 | Commit 36fb879 | closed | Closed issue with commit/test evidence | Tests: gh issue close/comment #606
- [2026-02-09 22:14 MST] Issue #597-#606 | Commit 36fb879 | resolved | Completed all reviewer-required R7 implementation items, removed top-level Reviewer Required Changes block, and preserved full per-issue evidence in append-only execution log entries | Tests: see issue-linked command logs and commits 3007cd1/5835df0/0c85815/67e5921/30352d4/06488fc/64a1f58/80494dc/0318eec/36fb879
- [2026-02-09 22:14 MST] Issue #n/a | Commit 36fb879 | validated | Passed final branch regression gate after R7 fixes | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
- [2026-02-09 22:14 MST] Issue #n/a | Commit 36fb879 | moved_to_review | Moved spec 110 from 02-in-progress to 03-needs-review after closing reviewer-required R7 issues #597-#606 and passing final validation gate | Tests: go vet ./...; go build ./...; go test -race ./internal/api/... -count=1; npm run test:bridge; cd web && npx vitest run
